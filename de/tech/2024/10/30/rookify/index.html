<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  

  <title>Rookify: Migration von Ceph-Ansible zu Rook | Sovereign Cloud Stack</title>
  <meta property="og:title" content="Rookify: Migration von Ceph-Ansible zu Rook | Sovereign Cloud Stack">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:locale" content="de" />
<meta name="description" content="Um den Übergang von Ceph-Ansible zu Rook zu erleichtern, hat SCS ein Migrationswerkzeug namens Rookify fast fertig entwickelt. Dieses Tool vereinfacht und optimiert den Migrationsprozess, sodass Benutzer problemlos von einer Ceph-Ansible-Installation zu Rook wechseln können. Das Tool befindet sich derzeit in einem ersten technischen Preview und wird getestet." />
<meta property="og:description" content="Um den Übergang von Ceph-Ansible zu Rook zu erleichtern, hat SCS ein Migrationswerkzeug namens Rookify fast fertig entwickelt. Dieses Tool vereinfacht und optimiert den Migrationsprozess, sodass Benutzer problemlos von einer Ceph-Ansible-Installation zu Rook wechseln können. Das Tool befindet sich derzeit in einem ersten technischen Preview und wird getestet." />
<link rel="canonical" href="https://sovereigncloudstack.github.io/website/tech/2024/10/30/rookify/" />
<meta property="og:url" content="https://sovereigncloudstack.github.io/website/tech/2024/10/30/rookify/" />
<meta property="og:site_name" content="Sovereign Cloud Stack" />
<meta property="og:image" content="https://sovereigncloudstack.github.io/website/website/assets/images/default-card-d32fdb798ca15ae927f00593ce64407f69c70d4011955dc94c7be76b99c474f4e673ee1a26ec53725dda80c2c331e5ad4300a43e702171cc014cd47ec6b2f94d.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-10-30T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://sovereigncloudstack.github.io/website/website/assets/images/default-card-d32fdb798ca15ae927f00593ce64407f69c70d4011955dc94c7be76b99c474f4e673ee1a26ec53725dda80c2c331e5ad4300a43e702171cc014cd47ec6b2f94d.jpg" />
<meta property="twitter:title" content="Rookify: Migration von Ceph-Ansible zu Rook" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-09-30T08:38:05+00:00","datePublished":"2024-10-30T00:00:00+00:00","description":"Um den Übergang von Ceph-Ansible zu Rook zu erleichtern, hat SCS ein Migrationswerkzeug namens Rookify fast fertig entwickelt. Dieses Tool vereinfacht und optimiert den Migrationsprozess, sodass Benutzer problemlos von einer Ceph-Ansible-Installation zu Rook wechseln können. Das Tool befindet sich derzeit in einem ersten technischen Preview und wird getestet.","headline":"Rookify: Migration von Ceph-Ansible zu Rook","image":"default-card.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://sovereigncloudstack.github.io/website/tech/2024/10/30/rookify/"},"url":"https://sovereigncloudstack.github.io/website/tech/2024/10/30/rookify/"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="https://sovereigncloudstack.github.io/website/feed.xml" title="Sovereign Cloud Stack" />


  <!-- Bootstrap core JavaScript -->
  <script src="/website/assets/vendor/jquery/jquery-9890bc3f6e101de456f751d876e987f1f4b90f5ad9df054375f77306c1afa9aa5781536b68c7a14d9653b12f5f22e6f2b3b363f583e4b1a7f079be6dfa5854d1.js" type="text/javascript"></script>
  <script src="/website/assets/vendor/bootstrap/js/bootstrap.bundle-60934d7b67216797538563fa77a226032bb2823e090abf271dd8f8772c72643f26033fb09fde7cf02e8520dee7b9b4d583e4ae0cf81c9a492f0695e3cf85eb30.js" type="text/javascript"></script>
  <!-- Lighbox -->
  <script src="/website/assets/vendor/lightbox-5dc80144ffe76fd27b40a8e12589c5d0d75b711ed7a7673347d8432a0d910ed4412e58da517985a7e84118687326c43f9ecadf23563007d27225b8688ab94ccc.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="/website/assets/css/lightbox-49997aacc14bff6792a1811e3616ecba8d58e0e4598c6f84c2800946d62462c8ed8fcfdf6f10088844e274b9482ffee4fbf6d37d67f85c0f1514e993ad3b9072.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="/website/assets/css/main-ed12d9c273c732a194d0f8e3ec09afcd4282bb2b71530e644874b2d51197007ff8f26efce55b40a901be813a91f54d6b02914d44316cfa360c4d45db632323cb.css">
  <!-- Pygments CSS -->
  <link rel="stylesheet" type="text/css" href="/website/assets/css/pygments-css/zenburn-b9e6749823dd76c51d2a88eb53602d9218592303de1e7d1a4523c503894f18810ddd0f4062286c1dbd89a9405bfe9020d23afce2785ef82c5ea814129bd4327a.css">
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/website/assets/images/apple-touch-icon-50d41dce7bb6498cab01cffd5f46e59a664056fd725ecf84d9c8e5ad9ac8ca1470a0b82fe79789d09136c4a7999658948394d89d9764e4174dfeec26fa7636ae.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/website/assets/favicon-32x32-c5b260bd36bab2cb0496cec647907efc38ca4ac5cb5c978603405fe682da762b16d3b21e997fc85c1c76db4e4bae08787a9a9cbfeb38c7b796ea6de38011953b.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/website/assets/favicon-16x16-01a7499e8495e00e13117aca0a759d19faeca0c8fe23c003bf5aabef7b7b5abbbb1ad3d149d0630d9997f941fb53e13d85a950be0104d76283df37fbaba34717.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="mask-icon" color="#50c3a5" href="/website/assets/images/safari-pinned-tab-3194c271a2bc561b5707fb2998d39947f8feeabebcc64dfb41004e04f7ae120a6ae7157839c91b2b6f0920545a23959142d86e565ba6250800bafb99a2237583.svg" />
  <meta name="msapplication-config" content="/browserconfig.xml" />
  <meta name="msapplication-TileColor" content="#50c3a5">
  <meta name="theme-color" content="#ffffff">
</head>

<nav class="navbar navbar-light fixed-bottom" style="background-color: var(--bs-warning)">
  <div class="container">
    <span><i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Staging website – Based on commit <a href="https://github.com/SovereignCloudStack/website/commit/685a8141acabe7a4df24689815448ee259e39dda" target="_blank"><span class="badge rounded-pill bg-secondary">685a81</span></a></span>
  </div>
</nav>

<body class="d-flex flex-column min-vh-100">
  <!-- Navigation -->
<nav class="navbar navbar-dark bg-gold sticky-top" style="height: 55px;">
  <div class="container d-flex justify-content-center">
	  <a class="lh-1 fw-bolder link-unstyled text-center stretched-link" href="https://sovereigncloudstack.org/">Entdecke unsere neue Webseite</a>
  </div>
</nav>
<nav class="navbar navbar-expand-lg navbar-light sticky-top bg-light">
  <div class="container align-items-start">
    <div class="d-lg-flex flex-row flex-fill align-items-end">
      <button
        class="navbar-toggler me-auto"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto">
          
          <li class="nav-item">
            
              <a class="nav-link" href="/website/de/">
                Home
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                SCS entdecken
              </a>
                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                  
                    <li><a class="dropdown-item" href="/website/de/about/">Über SCS</a></li>
                  
                    <li><a class="dropdown-item" href="/website/de/use/">SCS nutzen</a></li>
                  
                    <li><a class="dropdown-item" href="/website/de/contribute/">Zu SCS beitragen</a></li>
                  
                    <li><a class="dropdown-item" href="/website/de/partners/">Servicepartner</a></li>
                  
                    <li><a class="dropdown-item" href="/website/de/members/">Community Members</a></li>
                  
              </ul>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/website/de/news/">
                Neuigkeiten
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/website/de/events/">
                Veranstaltungen
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/website/de/jobs/">
                Offene Stellen
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/website/de/tenders/">
                Ausschreibungen
              </a>
            
          
          </li>
          <li><a class="nav-link" href="https://docs.scs.community">Dokumentation</a></li>
        </ul>
        <ul class="navbar-nav flex-row align-content-end">
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://social.osb-alliance.de/@SCS">
              <i class="fa fa-mastodon fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://www.linkedin.com/company/sovereigncloudstack">
              <i class="fa fa-linkedin-square fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://www.youtube.com/@sovereigncloudstack">
              <i class="fa fa-youtube-square fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://github.com/SovereignCloudStack">
              <i class="fa fa-github fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org">
              <i class="fa fa-matrix-org fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://scs.sovereignit.de/mailman3/postorius/lists/announce.lists.scs.community/">
              <i class="fa fa-bullhorn"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="/feed.xml">
              <i class="fa fa-rss"></i>
            </a>
          </li>
          
        </ul>
      </div>
      <div class="d-none d-lg-block">
        <ul class="navbar-nav flex-row">
  <li class="nav-item my-auto ms-4 ms-lg-2">
    <a class="nav-link fw-bold  " href="/website/tech/2024/10/30/rookify/">EN</a>
  </li>
  <li class="nav-item my-auto mx-2 mx-lg-0">
    <span class="nav-link px-0">/</span>
  </li>
  <li clas="nav-item my-auto">
    <a class="nav-link fw-bold   text-decoration-underline " href="/website/de/tech/2024/10/30/rookify/">DE</a>
  </li>
</ul>
      </div>
    </div>
    <div class="d-lg-none">
      <ul class="navbar-nav flex-row">
  <li class="nav-item my-auto ms-4 ms-lg-2">
    <a class="nav-link fw-bold  " href="/website/tech/2024/10/30/rookify/">EN</a>
  </li>
  <li class="nav-item my-auto mx-2 mx-lg-0">
    <span class="nav-link px-0">/</span>
  </li>
  <li clas="nav-item my-auto">
    <a class="nav-link fw-bold   text-decoration-underline " href="/website/de/tech/2024/10/30/rookify/">DE</a>
  </li>
</ul>
    </div>
  </div>
</nav>
 <!-- Header -->
<header class="bg-white py-2 mb-2">
  <div class="container h-100">
    <div class="row h-100 align-items-center">
      <div class="col-lg-6 pe-lg-4">
        <div class="mt-5 mb-3">
          <img alt="Sovereign Cloud Stack" width="50%" class="img-fluid" src="/website/assets/images/SCS_horizontal-749ea34c9192a57edc36f112b92ac2eddb847d3e47643f37488b3d148c9b98a720215c0c8e17ad0d3837c9056ae6feae3cdc931ed36e911b2b1b61a20b417de6.svg">
        </div>
        <p class="lead text-black-50 mb-lg-3">
          Eine Plattform — standardisiert, entwickelt und betrieben von Vielen.
        </p>
      </div>
      <div class="col-lg-6 text-lg-end text-nowrap my-auto">
        <a href="https://osb-alliance.com" target="_blank" class="text-decoration-none">
          <img alt="Open Source Business Alliance" width="25%" class="img-fluid" src="/website/assets/images/logo-osba-615e489a04d99f1ead83a6fa64d76dfc96d1f6a8448ee5457099e2bc8fddb235379f6607e917a0fcfb519ff1902ac5596213d7339ef9f48a0925aaf2b1221ee0.svg">
        </a>
        <a href="https://bmwk.de" target="_blank" class="text-decoration-none">
          <img alt="Bundesministerium für Wirtschaft und Klimaschutz" width="25%" class="img-fluid ms-5" src="/website/assets/images/logo-bmwk-funded-a4b929201f73ab45853836459b686db98f0b2e37189400588ce992a51c6c59d371835e93cd0d5b891f05fce75d6b87383c3fc12d52c6d560c5602eb32bf58b90.svg">
        </a>
        <a href="https://gaia-x.eu" target="_blank" class="text-decoration-none">
          <img alt="Gaia-X" width="30%" class="img-fluid ms-3" src="/website/assets/images/logo-gaiax-fbfa0132aaba3946d970e942fd98ef403abb12f8f344cc3087fcb466e23424b0d7dddd9b8b2ce4979df58e4b78e48f0419eb721e0f0599bd89df6b46c2871c43.svg">
        </a>
      </div>
    </div>
  </div>
</header>

  <!-- Page Content -->
  <div class="container mb-5">
    
<div class="d-flex w-100 flex-column mb-3">
	<h1 class="pb-1 mb-0"><small>Rookify: Migration von Ceph-Ansible zu Rook</small></h1>
	<div class="d-flex w-100 flex-row">
		<div style="max-width: 80px; max-height: 80px;" class="rounded-3 overflow-hidden ratio ratio-1x1">
			<div style="max-width: 80px; max-height: 80px;" class="overflow-hidden ratio ratio-1x1">

  <svg height="80" width="80">
    
    
    <mask id="60c2d26c3bcb">
      <rect width="80" height="80" fill="white"/>
    </mask>
    <mask id="06454efd6214">
        <circle cx="40" cy="40" r="40" fill="white"/>
    </mask>
    <image x="0" y="0" height="80" width="80" xlink:href="/website/assets/7fddc2-4710a7886bc3ac920bcf97be3c5f4dbfe319c1472e3884f454cc6bab6d2e6a7a79f1c81471b7e5dc5493c38ba412ff34ed78e0a1b2f8fe4bf9beb15693ac2028.webp"
       mask="url(#06454efd6214)" 
    ></image>
  </svg>

</div>

		</div>
		<div class="d-flex w-100 flex-column ms-3 my-auto">
			<small class="mb-1 fw-bolder">Rafael te Boekhorst</small>
			<small>
	30.
	
	Oktober
	  
	2024

</small>
		</div>
	</div>
</div>

<p>Um den Übergang von Ceph-Ansible zu Rook zu erleichtern, hat SCS ein Migrationswerkzeug namens <a href="https://github.com/SovereignCloudStack/rookify">Rookify</a> fast fertig entwickelt. Dieses Tool vereinfacht und optimiert den Migrationsprozess, sodass Benutzer problemlos von einer Ceph-Ansible-Installation zu Rook wechseln können. Das Tool befindet sich derzeit in einem ersten technischen Preview und wird getestet.</p>

<h2 id="funktionen-und-design">Funktionen und Design</h2>

<h3 id="statemachine-zustandsautomat">Statemachine (Zustandsautomat)</h3>

<p>Rookify ist ein Python-Paket, das einen auf <a href="https://github.com/pytransitions/transitions">‘transitions’</a> basierenden Zustandsautomaten-Ansatz verwendet, um verschiedene Ressourcen (wie Monitore, Manager, OSDs, MDS und Andere) zu Rook zu migrieren. Jede dieser Ressourcen hat ein entsprechendes <a href="https://github.com/SovereignCloudStack/rookify/tree/main/src/rookify/modules">Modul</a> in Rookify, das unabhängig oder in Kombination mit anderen Modulen ausgeführt werden kann.</p>

<p>Es ist wichtig zu beachten, dass die meisten Module Abhängigkeiten zu anderen Modulen haben und diese bei Bedarf implizit ausführen. Zum Beispiel muss das <code class="language-plaintext highlighter-rouge">migrate_mons</code> Modul zuerst das <code class="language-plaintext highlighter-rouge">analyze_ceph</code> Modul ausführen (wie durch die <a href="https://github.com/SovereignCloudStack/rookify/blob/main/src/rookify/modules/migrate_monitors/main.py">REQUIRES-Variable</a> angegeben). Dies ist notwendig, damit Rookify den aktuellen Standort der Monitore bestimmen und festlegen kann, wohin sie migriert werden sollen.</p>

<p>Rookify kann durch Bearbeiten einer umfassenden <code class="language-plaintext highlighter-rouge">config.yaml</code>-Datei konfiguriert werden, wie zum Beispiel in der bereitgestellten <a href="https://github.com/SovereignCloudStack/rookify/blob/main/config.example.yaml">config.example.yaml</a>. Diese Konfigurationsdatei spezifiziert verschiedene Abhängigkeiten (wie SSH-Schlüssel, Kubernetes- und Ceph-Konfigurationen) und ermöglicht es Benutzern, einfach zu entscheiden, welche Module ausgeführt werden sollen (siehe den Abschnitt <code class="language-plaintext highlighter-rouge">migration_modules</code> unten im <code class="language-plaintext highlighter-rouge">config.yaml</code>).</p>

<h3 id="pickle-unterstützung">Pickle-Unterstützung</h3>

<p>Rookify unterstützt optional (empfohlen) die Verwendung einer <strong>Pickle-Datei</strong> (siehe oben im Abschnitt <code class="language-plaintext highlighter-rouge">general</code> in <code class="language-plaintext highlighter-rouge">config.example.yaml</code>). Pickle ist ein Modul zur Objektserialisierung, dass den Fortschrittsstatus extern speichert, d.h. welche Module ausgeführt wurden und Informationen über die Zielmaschine. Das bedeutet:</p>

<ul>
  <li>Wenn eine laufende Migration aus irgendeinem Grund gestoppt wird, kann Rookify die Pickle-Datei verwenden, um vom gespeicherten Zustand fortzufahren.</li>
  <li>Wenn eine Migration in Teilen ausgeführt wird (z.B. Module werden inkrementell ausgeführt), ermöglicht es die Pickle-Datei den Zustand des Clusters, d.h. der Migration, zu speichern.</li>
</ul>

<p>⚠️ <strong>Wichtig</strong>:
Die Pickle-Datei sollte manuell gelöscht werden, wenn dieselbe Rookify-Installation verwendet werden soll, um mehr als ein Cluster zu migrieren, oder wenn sich das eine Cluster plötzlich erheblich geändert hat.</p>

<h3 id="ein-einfaches-cli">Ein einfaches CLI</h3>

<p>Derzeit bietet Rookify eine simple CLI-Schnittstelle, die durch Ausführen von <code class="language-plaintext highlighter-rouge">rookify</code> mit <code class="language-plaintext highlighter-rouge">-h</code> oder <code class="language-plaintext highlighter-rouge">--help</code> angezeigt werden kann:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usage: Rookify <span class="o">[</span><span class="nt">-h</span><span class="o">]</span> <span class="o">[</span><span class="nt">-d</span><span class="o">]</span> <span class="o">[</span><span class="nt">-m</span><span class="o">]</span> <span class="o">[</span><span class="nt">-s</span><span class="o">]</span>

Optionen:
  <span class="nt">-h</span>, <span class="nt">--help</span>         Zeigt diese Hilfemeldung an und beendet das Programm.
  <span class="nt">-d</span>, <span class="nt">--dry-run</span>      Vorab-Analyse der Daten und Validierung der Migration.
  <span class="nt">-m</span>, <span class="nt">--migrate</span>      Führe die Migration durch.
  <span class="nt">-s</span>, <span class="nt">--show-states</span>  Zeigt den Status der Module an.
</code></pre></div></div>

<p>Das Argument <code class="language-plaintext highlighter-rouge">-m</code> oder <code class="language-plaintext highlighter-rouge">--migrate</code> wurde hinzugefügt, um Rookify (wirklich) auszuführen, während die Ausführung ohne Argumente im Preflight-Modus läuft, d.h. mit <code class="language-plaintext highlighter-rouge">-d</code> oder <code class="language-plaintext highlighter-rouge">--dry-run</code>.</p>

<p>Das Argument <code class="language-plaintext highlighter-rouge">-s</code> oder <code class="language-plaintext highlighter-rouge">--show-states</code> wurde hinzugefügt, um den Fortschritt zu verfolgen. Hierzu wird die Pickle-Datei ausgelesen. Anschließend berichtet jedes Modul über den bekannten Zustand auf <code class="language-plaintext highlighter-rouge">stdout</code>.</p>

<h3 id="rookifys-arbeitsablauf-wie-wird-die-aufgabe-erledigt">Rookify’s Arbeitsablauf: Wie wird die Aufgabe erledigt?</h3>

<p>Die Hauptfunktion von Rookify ist es, alle Ressourcen von Ceph zu Rook zu migrieren. Schauen wir uns den Abschnitt migration_modules in der <code class="language-plaintext highlighter-rouge">config.yaml</code>-Datei an:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config.yaml</span>
<span class="na">migration_modules</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">migrate_mons</span>
</code></pre></div></div>

<p>Diese Konfiguration lässt Rookify die folgenden Schritte ausführen:</p>

<ol>
  <li>Preflight-Modus: Das <code class="language-plaintext highlighter-rouge">migrate_mons</code> Modul läuft zuerst im Preflight-Modus, der auch manuell mit dem Befehl <code class="language-plaintext highlighter-rouge">rookify --dry-run</code> ausgelöst werden kann. In dieser Phase führt Rookify die Preflight-Methoden für die konfigurierten Module und ihre abhängigen Module aus. Außerdem überprüft Rookify den Ausführungsstatus aus der Pickle-Datei. Wenn die Migration bereits erfolgreich abgeschlossen wurde, endet das Modul hier.</li>
  <li>Abhängigkeitsprüfung: Wenn das <code class="language-plaintext highlighter-rouge">migrate_mons</code> Modul noch nicht ausgeführt wurde (angezeigt durch eine leere Pickle-Datei), überprüft Rookify auf Abhängigkeiten, z.B. andere Module, die zuerst ausgeführt werden müssen. Es führt diese Module zuerst im Preflight-Modus und dann in Echtzeit aus. Der Status jedes Moduls wird optional in der Pickle-Datei gespeichert.
    <ol>
      <li>Das <code class="language-plaintext highlighter-rouge">analyze_ceph</code> Modul: Rookify erkennt, dass das <code class="language-plaintext highlighter-rouge">analyze_ceph</code> Modul in jedem Fall zuerst ausgeführt werden muss. Das <code class="language-plaintext highlighter-rouge">analyze_ceph</code> Modul sammelt Daten über die laufenden Ceph-Ressourcen und die Kubernetes-Umgebung mit dem dort laufendem Rook-Operator. Beachten Sie, dass <code class="language-plaintext highlighter-rouge">analyze_ceph</code> zuerst, wie bei jedem anderen Modul, im Preflight-Modus läuft. Es wird geprüft, ob der Zustand bereits in der Pickle-Datei erfasst wurde. Wenn kein Zustand gefunden wird, sammelt <code class="language-plaintext highlighter-rouge">analyze_ceph</code> die notwendigen Informationen.</li>
      <li>Das <code class="language-plaintext highlighter-rouge">k8s_prerequisites_check</code> Modul: Hier erfolgt die Validierung für die k8s-Namespaces, da der Cluster-Namespace manuell erstellt werden muss. Nur die CephCluster-Ressource wird im nächsten Schritt durch <code class="language-plaintext highlighter-rouge">create_rook_cluster</code> erzeugt.</li>
      <li>Das <code class="language-plaintext highlighter-rouge">create_rook_cluster</code> Module : Nach erfolgreicher Ausführung der <code class="language-plaintext highlighter-rouge">analyze_ceph</code> und <code class="language-plaintext highlighter-rouge">k8s_prerequisites_check</code> Module überprüft Rookify auf weitere Abhängigkeiten wie das <code class="language-plaintext highlighter-rouge">create_rook_cluster</code> Modul. Dieses Modul erstellt die <code class="language-plaintext highlighter-rouge">clustermap.yaml</code> für Rook basierend auf den Informationen aus <code class="language-plaintext highlighter-rouge">analyze_ceph</code> und <code class="language-plaintext highlighter-rouge">k8s_prerequisites_check</code>.</li>
    </ol>
  </li>
  <li>Migrationsausführung: Nach erfolgreicher Ausführung von <code class="language-plaintext highlighter-rouge">analyze_ceph</code> und <code class="language-plaintext highlighter-rouge">create_cluster</code> wird das <code class="language-plaintext highlighter-rouge">migrate_mons</code> Modul ausgeführt. Rookify fährt den ersten laufenden Ceph-Monitor auf dem ersten Worker-Node herunter (indem es <code class="language-plaintext highlighter-rouge">sudo systemctl disable --now ceph-mon.target</code> verwendet) und aktiviert sofort den entsprechenden Monitor in Rook (indem es seine Metadaten in der <code class="language-plaintext highlighter-rouge">clustermap.yaml</code> auf “true” setzt).</li>
  <li>Monitor-Migration: Rookify setzt diesen Prozess für jeden Monitor fort, bis alle zu Rook migriert und in Betrieb genommen wurden. Optional kann der Zustand in der Pickle-Datei gespeichert werden.</li>
</ol>

<p>Für sowohl Manager als auch Monitore wird Rookify den gerade beschriebenen Ansatz verwenden: Es wird versuchen, die Ceph-Ressource auszuschalten, nachdem sichergestellt wurde, dass eine entsprechende Ressource im Rook-Cluster neu erstellt werden kann. Bei OSDs und MDSs ist der Migrationsalgorithmus jedoch etwas anders.</p>

<h3 id="migration-von-osds">Migration von OSDs</h3>

<p>Hier funktioniert der für Manager und Monitore beschriebene „Eins-nach-dem-anderen“-Algorithmus nicht, da Rook einen Container namens <code class="language-plaintext highlighter-rouge">rook-ceph-osd-prepare</code> verwendet, der immer versucht, alle OSDs auf einem Pfad zu finden und sie gleichzeitig zu erstellen. Beachten Sie, dass es Konfigurationsoptionen gibt, die den Eindruck erwecken, dies zu handhaben, wie <code class="language-plaintext highlighter-rouge">useAllNodes=false</code> und <code class="language-plaintext highlighter-rouge">useAllDevices=false</code> (siehe <a href="https://rook.io/docs/rook/latest-release/CRDs/Cluster/host-cluster/#all-devices">rook docs</a>). Beide Variablen sind standardmäßig in der Rook-Bereitstellung von OSISM auf „false“ gesetzt, dennoch versucht <code class="language-plaintext highlighter-rouge">rook-ceph-osd-prepare</code>, alle OSDs pro Knoten zu scannen und zu verarbeiten. Dies bedeutet in der Praxis, dass ein <code class="language-plaintext highlighter-rouge">device is busy</code>-Fehler sowie ein Crashloop-Feedback auftreten werden. Dieses Verhalten wurde durch das Herunterfahren aller OSD-Dämonen pro Knoten entschärft:</p>

<ol>
  <li>Alle OSD-Daemons pro Node müssen gleichzeitig ausgeschaltet werden.</li>
  <li>Die Pfade der OSD-Geräte müssen einzeln an <code class="language-plaintext highlighter-rouge">prepare_osd</code> übergeben werden, um eine sequenzielle Verarbeitung zu erzwingen.</li>
  <li>Warten, bis jeder OSD auf dem Knoten gestartet ist, bevor fortgefahren wird.</li>
</ol>

<h3 id="migration-von-mdss">Migration von MDSs</h3>

<p>Der „Eins-nach-dem-anderen“-Algorithmus funktioniert hier ebenfalls nicht, da Rook möglicherweise Instanzen aktualisieren (also updaten) möchte, während die Migration im Gange ist. Dies kann zum Beispiel passieren, wenn eine MDS-Instanz des Ceph-Ansible-Deployments abgeschaltet wird und Rook diese Instanz innerhalb von Kubernetes neu erstellen will. Dann möchte Rook möglicherweise alle MDS-Instanzen aktualisieren und wird daher versuchen, alle Instanzen versuchen auszuschalten: auch diejenigen, die noch unter Ceph-Ansible laufen. Rook kann diese Instanzen nicht erreichen und es werden dadurch Abhängigkeiten innerhalb von Rook nicht aufgelöst.</p>

<p>Eine Möglichkeit dieses Problem zu lösen wäre, alle MDS-Instanzen unter Ceph-Ansible auszuschalten und Rook zu erlauben, sie alle neu zu erstellen. Das würde jedoch zu minimalen Ausfallzeiten führen und Rookify strebt an, keine Ausfallzeiten zu verursachen.</p>

<p>Deshalb verwendet Rookify derzeit den folgenden Ansatz:</p>

<ol>
  <li>Zwei MDS-Instanzen (mindestens eine muss aktiv sein) werden unter Ceph-Ansible belassen, alle anderen werden ausgeschaltet. Zum Beispiel, im Falle von insgesamt drei MDS-Instanzen wird nur eine MDS-Instanz ausgeschaltet.</li>
  <li>Von den verbliebenen zwei Instanzen wird nun die erste ebenfalls abgeschaltet aber anschließend in Rook zum Scheduling freigegeben, sodass eine Rook-Instanz startet. Auf diesen Start wird gewartet, bevor die zweite (verbliebene) Instanz abgeschaltet und in Rook aktiviert wird. Alle weiteren Instanzen werden anschließend in Rook abgebildet.</li>
</ol>

<h2 id="testlauf-ausprobieren-und-beim-testen-helfen">Testlauf: Ausprobieren und beim Testen helfen</h2>

<p>Um mit Rookify zu beginnen, stellen Sie sicher, dass Sie die <a href="https://github.com/SovereignCloudStack/rookify/blob/main/README.md">README.md</a> im Repository durchlesen.</p>

<p>Wenn Sie den aktuellen Stand von Rookify testen möchten (sehr geschätzt - melden Sie gerne <a href="https://github.com/SovereignCloudStack/rookify/issues">Issues</a> bei Github), können Sie das Testbed von OSISM verwenden.</p>

<h3 id="testbed-einrichtung">Testbed-Einrichtung</h3>

<p>ℹ️ <strong>Info:</strong>
 Das OSISM-Testbed ist für Testzwecke gedacht, was bedeutet, dass es instabil sein kann. Wenn Ceph und K3s nicht fehlerfrei bereitgestellt werden können, müssen Sie möglicherweise auf eine Fehlerbehebung warten oder eine Umgehungslösung finden, um Rookify zu testen.</p>

<p>Um das Testbed einzurichten, konsultieren Sie zunächst die <a href="https://osism.tech/docs/guides/other-guides/testbed">Testbed-Dokumentation von OSISM</a>  um sicherzustellen, dass Sie alle Anforderungen erfüllen. Wenn alles in Ordnung ist, klonen Sie das Repository und verwenden Sie make ceph, um ein Ceph-Testbed einzurichten. Dieser Befehl zieht automatisch die notwendigen Ansible-Rollen, bereitet eine virtuelle Umgebung vor, baut die Infrastruktur mit OpenStack, erstellt einen Manager-Node und stellt Ceph auf drei Worker-Nodes bereit:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone github.com:osism/testbed.git
make ceph
</code></pre></div></div>

<p>Sobald die Infrastruktur für Ceph und das Testbed bereitgestellt wurde, melden Sie sich mit <code class="language-plaintext highlighter-rouge">make login</code> an und stellen Sie K3s sowie einen Rook-Operator bereit:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make login 
osism apply k3s
osism apply rook-operator
</code></pre></div></div>

<p>Wenn Sie Konfigurationen ändern möchten, z.B. eine Rook-Einstellung, gehen Sie zu <code class="language-plaintext highlighter-rouge">/opt/configuration/environments/rook/</code> und sehen Sie in der <a href="https://osism.tech/docs/guides/configuration-guide/rook">Dokumentation zu Rook von OSISM</a> nach, um verschiedene Einstellungen zu finden.</p>

<h3 id="rookify-einrichtungkonfiguration-für-das-testbed-von-osism">Rookify-Einrichtung/Konfiguration für das Testbed von OSISM</h3>

<h4 id="1-klonen-des-rookify-repositorys">1. Klonen des Rookify-Repository’s</h4>

<p>Führen Sie <code class="language-plaintext highlighter-rouge">make setup</code> aus, damit automatisch das Rookify-Repository gekloned und aufgesetzt wird: es erstellt automatisch eine virtuelle Python-Umgebung, lädt die nötigen Python-Bybliotheken herunter und baut damit ein Python Packet für Rookify in <code class="language-plaintext highlighter-rouge">./.venv/bin/rookify</code>. Sie können auch die andere Hilfefunktionen des Makefile auflisten lassen, indem Sie einfach <code class="language-plaintext highlighter-rouge">make</code> (das gleiche wie <code class="language-plaintext highlighter-rouge">make help</code>) im Stammverzeichnis des Arbeitsverzeichnisses ausführen.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/SovereignCloudStack/rookify
<span class="nb">cd </span>rookify
make setup
</code></pre></div></div>

<p>ℹ️ <strong>Info:</strong>
 Wenn Sie einen Fehler der <code class="language-plaintext highlighter-rouge">python-rados</code>-Bibliothek erhalten, können Sie <code class="language-plaintext highlighter-rouge">make check-radoslib</code> ausführen, um zu prüfen, ob die Bibliothek lokal installiert ist. Wenn nicht, installieren Sie das Paket manuell. Die python-rados-Bibliothek sollte zum Zeitpunkt des Schreibens Version 2.0.0 sein (überprüfen Sie die README.md-Datei von Rookify für die aktuellste Dokumentation). Die Bibliothek konnte nicht in die Einrichtung integriert werden, da Ceph derzeit keine Builds für pip anbietet.</p>

<h4 id="2-konfigurieren-von-rookify">2. Konfigurieren von Rookify</h4>

<p>Kopieren Sie <code class="language-plaintext highlighter-rouge">config.example.osism.yaml</code> nach <code class="language-plaintext highlighter-rouge">config.yaml</code>und ändern Sie die verschiedenen Konfigurationseinstellungen nach Bedarf. Rookify benötigt Zugriff auf einen SSH-Schlüssel (z.B. die <code class="language-plaintext highlighter-rouge">.id_rsa</code>-Datei im Terraform-Verzeichnis im Testbed-Repository), Ceph-Konfigurationsdateien (siehe <code class="language-plaintext highlighter-rouge">/etc/ceph/</code> auf einem der Worker-Nodes) und Kubernetes-Dateien (z.B. <code class="language-plaintext highlighter-rouge">~/.kube/config</code> vom Manager-Node). Prüfen Sie gegebenfalls, ob das Makefile Hilfsfunktionen enthält, die Ihnen helfen können.</p>

<p>📝 <strong>Hinweis:</strong>
Stellen Sie sicher, dass Rookify eine Verbindung zum Testbed herstellen kann. Weitere Informationen zum Einrichten einer VPN-Verbindung finden Sie in der <a href="https://osism.tech/docs/guides/other-guides/testbed/#vpn-access">OSISM-Dokumentation</a>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">general</span><span class="pi">:</span>
  <span class="na">machine_pickle_file</span><span class="pi">:</span> <span class="s">data.pickle</span>

<span class="na">logging</span><span class="pi">:</span>
  <span class="na">level</span><span class="pi">:</span> <span class="s">INFO</span> <span class="c1"># Stufe, auf der das Logging beginnen soll</span>
  <span class="na">format</span><span class="pi">:</span>
    <span class="na">time</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%Y-%m-%d</span><span class="nv"> </span><span class="s">%H:%M.%S"</span> <span class="c1"># anderes Beispiel: "iso"</span>
    <span class="na">renderer</span><span class="pi">:</span> <span class="s">console</span> <span class="c1"># oder: json</span>

<span class="na">ceph</span><span class="pi">:</span>
  <span class="na">config</span><span class="pi">:</span> <span class="s">./.ceph/ceph.conf</span>
  <span class="na">keyring</span><span class="pi">:</span> <span class="s">./.ceph/ceph.client.admin.keyring</span>

<span class="c1"># korrekten Pfad zum privaten Schlüssel einfügen</span>
<span class="na">ssh</span><span class="pi">:</span>
  <span class="na">private_key</span><span class="pi">:</span> <span class="s">/home/USER/.ssh/cloud.private</span>
  <span class="na">hosts</span><span class="pi">:</span>
    <span class="na">testbed-node-0</span><span class="pi">:</span>
      <span class="na">address</span><span class="pi">:</span> <span class="s">192.168.16.10</span>
      <span class="na">user</span><span class="pi">:</span> <span class="s">dragon</span>
    <span class="na">testbed-node-1</span><span class="pi">:</span>
      <span class="na">address</span><span class="pi">:</span> <span class="s">192.168.16.11</span>
      <span class="na">user</span><span class="pi">:</span> <span class="s">dragon</span>
    <span class="na">testbed-node-2</span><span class="pi">:</span>
      <span class="na">address</span><span class="pi">:</span> <span class="s">192.168.16.12</span>
      <span class="na">user</span><span class="pi">:</span> <span class="s">dragon</span>

<span class="na">kubernetes</span><span class="pi">:</span>
  <span class="na">config</span><span class="pi">:</span> <span class="s">./k8s/config</span>

<span class="na">rook</span><span class="pi">:</span>
  <span class="na">cluster</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">osism-ceph</span>
    <span class="na">namespace</span><span class="pi">:</span> <span class="s">rook-ceph</span>
    <span class="na">mds_placement_label</span><span class="pi">:</span> <span class="s">node-role.osism.tech/rook-mds</span>
    <span class="na">mgr_placement_label</span><span class="pi">:</span> <span class="s">node-role.osism.tech/rook-mgr</span>
    <span class="na">mon_placement_label</span><span class="pi">:</span> <span class="s">node-role.osism.tech/rook-mon</span>
    <span class="na">osd_placement_label</span><span class="pi">:</span> <span class="s">node-role.osism.tech/rook-osd</span>
    <span class="na">rgw_placement_label</span><span class="pi">:</span> <span class="s">node-role.osism.tech/rook-rgw</span>
  <span class="na">ceph</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">quay.io/ceph/ceph:v18.2.1</span>

<span class="na">migration_modules</span><span class="pi">:</span> <span class="c1"># legt fest, welche Module ausgeführt werden sollen. Beachten Sie, dass einige der Module andere Module erfordern, die ebenfalls ausgeführt werden müssen. Dies geschieht automatisch.</span>
<span class="pi">-</span> <span class="s">analyze_ceph</span>
</code></pre></div></div>

<h4 id="3-rookify-ausführen">3. Rookify ausführen:</h4>

<p>Jetzt können Sie endlich Rookify ausführen um es zu testen. Rookify erlaubt die Verwendung von <code class="language-plaintext highlighter-rouge">--dry-run</code>, um Module im Preflight-Modus auszuführen. Beachten Sie, dass Rookify die verschiedenen Module immer zuerst im Preflight-Modus ausführt bevor anschließend, bei fehlerfreiem Durchlauf, eine Migration gestartet wird.</p>

<p>Wenn alles korrekt eingerichtet ist, können Sie Rookify ohne Argumente ausführen oder sie wagen es explizit <code class="language-plaintext highlighter-rouge">--migrate</code> als Argument zu geben. In diesem Fall machen Sie nichts kaput, wenn Sie das <code class="language-plaintext highlighter-rouge">analyze_ceph</code>-Modul auszuführen, da dieses keine kritischen Änderungen vornimmt:</p>

<p>📝 <strong>Hinweis:</strong>
  Ohne Argumente wird Rookify per default im Preflight-Modus laufen (es wird dann <code class="language-plaintext highlighter-rouge">--dry-run</code> hinzugefügt).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Preflight-Modus</span>
.venv/bin/rookify <span class="nt">--dry-run</span>
<span class="c"># Reales Ausführen: das analyze_ceph Modul sollte nichts kaputt machen</span>
.venv/bin/rookify <span class="nt">--migrate</span>
</code></pre></div></div>

<p>⚠️ <strong>Wichtig:</strong>
Es wird empfohlen, jedes Modul zuerst im Preflight-Modus auszuführen, um echte Änderungen zu vermeiden.</p>

<p>Sie sollten dann folgende Ausgabe auf der Konsole sehen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.venv/bin/rookify
2024-09-02 15:21.37 <span class="o">[</span>info     <span class="o">]</span> Execution started with machine pickle file
2024-09-02 15:21.37 <span class="o">[</span>info     <span class="o">]</span> AnalyzeCephHandler ran successfully.
</code></pre></div></div>

<p>Beachten Sie, dass es jetzt eine Datei “data.pickle” (je nach dem wie es benannt wurde im <code class="language-plaintext highlighter-rouge">config.yaml</code>) im Stammverzeichnis des Arbeitsverzeichnisses gibt. Diese Datei sollte Daten enthalten:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">du</span> <span class="nt">-sh</span> data.pickle
8.0K	data.pickle
</code></pre></div></div>

<p>An diesem Punkt können wir die Datei <code class="language-plaintext highlighter-rouge">config.yaml</code> erneut bearbeiten, um die osds-, mds-, mgr- und rgw- Ressourcen zu migrieren:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>migration_modules:
- analyze_ceph
- create_rook_cluster
- migrate_mons
- migrate_osds
- migrate_osd_pools
- migrate_mds
- migrate_mds_pools
- migrate_mgrs
- migrate_rgws
- migrate_rgw_pools
</code></pre></div></div>

<p>ℹ️ <strong>Info:</strong>
 Einige der Module sind redundant in dem Sinne, dass ihre <code class="language-plaintext highlighter-rouge">REQUIRED</code>-Variablen die Module bereits als ihre Abhängigkeiten enthalten. Zum Beispiel hat <code class="language-plaintext highlighter-rouge">migrate_osds</code> die folgende <code class="language-plaintext highlighter-rouge">REQUIRED</code>-Variable: <code class="language-plaintext highlighter-rouge">REQUIRES = [„migrate_mons“]</code>, und <code class="language-plaintext highlighter-rouge">migrate_mons</code> hat <code class="language-plaintext highlighter-rouge">REQUIRES = [„analyze_ceph“, „create_rook_cluster“]</code>. Man könnte also die ersten drei Module aus der Konfiguration entfernen. Die zusätzliche Erwähnung der Module kann hier aber die Übersichtlichkeit für den Leser verbessern. Tatsächlich wird Rookify die Module nur einmal ausführen, so dass es nicht schadet, sie in der <code class="language-plaintext highlighter-rouge">config.yaml</code> hinzuzufügen.</p>

<p>Wir können Rookify zunächst mit <code class="language-plaintext highlighter-rouge">pre-flight</code> starten, um zu prüfen, ob alles in Ordnung ist und es dann explizit mit dem Argument <code class="language-plaintext highlighter-rouge">--migrate</code> versehen, um die wirkliche Migration zu starten. Als Ergebnis sollten wir folgenden Output sehen:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.venv/bin/rookify
2024-09-04 08:52.02 [info     ] Execution started with machine pickle file
2024-09-04 08:52.04 [info     ] AnalyzeCephHandler ran successfully.
2024-09-04 08:52.04 [info     ] Validated Ceph to expect cephx auth
2024-09-04 08:52.04 [warning  ] Rook Ceph cluster will be configured without a public network and determine it automatically during runtime
2024-09-04 08:52.04 [info     ] Rook Ceph cluster will be configured without a cluster network
2024-09-04 08:52.11 [warning  ] ceph-mds filesystem 'cephfs' uses an incompatible pool metadata name 'cephfs_metadata' and can not be migrated to Rook automatically
2024-09-04 08:52.16 [info     ] Creating Rook cluster definition
2024-09-04 08:52.16 [info     ] Waiting for Rook cluster created
2024-09-04 08:52.16 [info     ] Migrating ceph-mon daemon 'testbed-node-0'
2024-09-04 08:52.32 [info     ] Disabled ceph-mon daemon 'testbed-node-0'
2024-09-04 08:53.45 [info     ] Quorum of 3 ceph-mon daemons successful
2024-09-04 08:53.45 [info     ] Migrating ceph-mon daemon 'testbed-node-1'
2024-09-04 08:54.07 [info     ] Disabled ceph-mon daemon 'testbed-node-1'
2024-09-04 08:54.44 [info     ] Quorum of 3 ceph-mon daemons successful
2024-09-04 08:54.44 [info     ] Migrating ceph-mon daemon 'testbed-node-2'
2024-09-04 08:55.04 [info     ] Disabled ceph-mon daemon 'testbed-node-2'
2024-09-04 08:55.52 [info     ] Quorum of 3 ceph-mon daemons successful
2024-09-04 08:55.52 [info     ] Migrating ceph-osd host 'testbed-node-0'
2024-09-04 08:55.55 [info     ] Disabled ceph-osd daemon 'testbed-node-0@0'
2024-09-04 08:55.57 [info     ] Disabled ceph-osd daemon 'testbed-node-0@4'
2024-09-04 08:55.57 [info     ] Enabling Rook based ceph-osd node 'testbed-node-0'
2024-09-04 08:57.00 [info     ] Rook based ceph-osd daemon 'testbed-node-0@0' available
2024-09-04 08:57.02 [info     ] Rook based ceph-osd daemon 'testbed-node-0@4' available
2024-09-04 08:57.02 [info     ] Migrating ceph-osd host 'testbed-node-1'
2024-09-04 08:57.05 [info     ] Disabled ceph-osd daemon 'testbed-node-1@1'
2024-09-04 08:57.07 [info     ] Disabled ceph-osd daemon 'testbed-node-1@3'
2024-09-04 08:57.07 [info     ] Enabling Rook based ceph-osd node 'testbed-node-1'
2024-09-04 08:58.46 [info     ] Rook based ceph-osd daemon 'testbed-node-1@1' available
2024-09-04 08:58.46 [info     ] Rook based ceph-osd daemon 'testbed-node-1@3' available
2024-09-04 08:58.46 [info     ] Migrating ceph-osd host 'testbed-node-2'
2024-09-04 08:58.48 [info     ] Disabled ceph-osd daemon 'testbed-node-2@2'
2024-09-04 08:58.50 [info     ] Disabled ceph-osd daemon 'testbed-node-2@5'
2024-09-04 08:58.50 [info     ] Enabling Rook based ceph-osd node 'testbed-node-2'
2024-09-04 09:00.25 [info     ] Rook based ceph-osd daemon 'testbed-node-2@2' available
2024-09-04 09:00.27 [info     ] Rook based ceph-osd daemon 'testbed-node-2@5' available
2024-09-04 09:00.27 [info     ] Migrating ceph-mds daemon at host 'testbed-node-0'
2024-09-04 09:00.27 [info     ] Migrating ceph-mds daemon at host 'testbed-node-1'
2024-09-04 09:00.27 [info     ] Migrating ceph-mds daemon at host 'testbed-node-2'
2024-09-04 09:00.27 [info     ] Migrating ceph-mgr daemon at host'testbed-node-0'
2024-09-04 09:01.03 [info     ] Disabled ceph-mgr daemon 'testbed-node-0' and enabling Rook based daemon
2024-09-04 09:01.20 [info     ] 3 ceph-mgr daemons are available
2024-09-04 09:01.20 [info     ] Migrating ceph-mgr daemon at host'testbed-node-1'
2024-09-04 09:01.51 [info     ] Disabled ceph-mgr daemon 'testbed-node-1' and enabling Rook based daemon
2024-09-04 09:02.09 [info     ] 3 ceph-mgr daemons are available
2024-09-04 09:02.09 [info     ] Migrating ceph-mgr daemon at host'testbed-node-2'
2024-09-04 09:02.41 [info     ] Disabled ceph-mgr daemon 'testbed-node-2' and enabling Rook based daemon
2024-09-04 09:03.00 [info     ] 3 ceph-mgr daemons are available
2024-09-04 09:03.00 [info     ] Migrating ceph-rgw zone 'default'
2024-09-04 09:03.00 [info     ] Migrated ceph-rgw zone 'default'
2024-09-04 09:03.00 [info     ] Migrating ceph-osd pool 'backups'
2024-09-04 09:03.01 [info     ] Migrated ceph-osd pool 'backups'
2024-09-04 09:03.01 [info     ] Migrating ceph-osd pool 'volumes'
2024-09-04 09:03.01 [info     ] Migrated ceph-osd pool 'volumes'
2024-09-04 09:03.01 [info     ] Migrating ceph-osd pool 'images'
2024-09-04 09:03.01 [info     ] Migrated ceph-osd pool 'images'
2024-09-04 09:03.01 [info     ] Migrating ceph-osd pool 'metrics'
2024-09-04 09:03.01 [info     ] Migrated ceph-osd pool 'metrics'
2024-09-04 09:03.01 [info     ] Migrating ceph-osd pool 'vms' 
2024-09-04 09:03.01 [info     ] Migrated ceph-osd pool 'vms'  
2024-09-04 09:03.01 [info     ] Migrating ceph-rgw daemon at host 'testbed-node-2'
2024-09-04 09:04.27 [info     ] Disabled ceph-rgw host 'testbed-node-2'
2024-09-04 09:04.35 [info     ] Rook based RGW daemon for node 'testbed-node-2' available
2024-09-04 09:04.35 [info     ] Migrating ceph-rgw daemon at host 'testbed-node-1'
2024-09-04 09:04.41 [info     ] Disabled ceph-rgw host 'testbed-node-1'
2024-09-04 09:05.09 [info     ] Rook based RGW daemon for node 'testbed-node-1' available
2024-09-04 09:05.09 [info     ] Migrating ceph-rgw daemon at host 'testbed-node-0'
2024-09-04 09:05.13 [info     ] Disabled ceph-rgw host 'testbed-node-0'
2024-09-04 09:05.19 [info     ] Rook based RGW daemon for node 'testbed-node-0' available
</code></pre></div></div>

<p>Wow! Wir sind von Ceph-Ansible nach Rook migriert!
Wenn wir jetzt in das Testbed einloggen können wir die “Health” des clusters nochmal mit <code class="language-plaintext highlighter-rouge">ceph -s</code> kontrollieren. Mit <code class="language-plaintext highlighter-rouge">kubectl</code> kann man noch checken, das alle Pods da sind.</p>



<h2 id="about">
  
    Über den Autor
  
</h2>




<div class="d-flex flex-md-row flex-column align-items-center mb-5">
    <div class="me-4 d-flex align-items-center">
      <svg height="120" width="120">
        
        <mask id="47c7bab3b3c6">
          <circle cx="60" cy="60" r="60" fill="white"/>
        </mask>
        <image x="0" y="0" height="120" width="120" xlink:href="/website/assets/4e5060-f2a0f23f4f4d8acbe29303318899efc0b59168d9152a35586487393df2b3616a66420dd7757dda50c63ac88be7857a692c3f819a6c590e6f4d679f64fe325956.webp" mask="url(#47c7bab3b3c6)"></image>
      </svg>
    </div>
    <div class="d-flex flex-column pe-3">
        <div class="mb-0 text-center text-md-start"><b>Rafael Boekhorst</b></div>
        <div class="small text-muted mt-0 text-center text-md-start">Junior Software Developer @ <a href="https://osism.tech/" target="_blank">B1 Systems GmbH</a></div>
        <div class="mt-2">Rafael is a Junior Software Developer with an interest in Open Source Software Development and Linux.
</div>
        <div class="mt-2 d-flex flex-row flex-wrap">
          
<div class="me-2 mb-2">
    <a class="btn btn-mail" href="mailto:boekhorstb1@b1-systems.de"><i class="fa fa-envelope fa-lg"></i></a>
</div>






<div class="me-2 mb-2">
    <a class="btn btn-github" target="_blank" href="https://github.com/boekhorstb1"><i class="fa fa-github fa-lg"></i></a>
</div>


<div class="me-2 mb-2">
    <a class="btn btn-matrix" target="_blank" href="https://matrix.to/#/@boekhorstb1:matrix.org"><i class="fa fa-matrix-org fa-lg"></i></a>
</div>

          <div class="ms-md-auto pe-3"><a href="/website/de/members/boekhorst" class="btn btn-outline-primary" role="button">Community-Profil &raquo;</a></div>
      </div>
    </div>
</div>



  </div>
  <!-- /.container -->
  <!-- Footer -->
<footer class="py-5 bg-dark">
  <div class="container text-light bg-dark">
    <div class="row">
      <div class="col-lg-5">
        <a href="#" class="footer-site-logo">
          <img alt="Sovereign Cloud Stack" class="img-fluid mb-2" src="/website/assets/images/SCS_short-1b31802be07ab137d2373f3cd2e268923d727ee1d19b6b577dff3b71610345de088c3b83c90f66897a21e52e84fa03c1ef4d1ca5193b8659b9c9535946aa0154.svg">
        </a>
        <p class="small my-1">Sovereign Cloud Stack, SCS und das Logo sind geschützte Marken der Open Source Business Alliance e.V. — Sonstige Marken sind Eigentum ihrer jeweiligen Besitzer.</p>
        <ul class="list-inline mt-2 mb-1">
          
          <li class="list-inline-item small me-sm-4 me-3">
            <i class="text-light fa fa-phone me-1"></i> <a class="text-light text-decoration-none" href="tel:+49-30-300149-3377" title="+49-30-300149-3377">+49-30-300149-3377</a>
          </li>
          
          <li class="list-inline-item small me-sm-4 me-3">
            <i class="text-light fa fa-envelope me-1"></i> <a class="text-light text-decoration-none" href="mailto:scs@osb-alliance.com" title="scs[at]osb-alliance[dot]com">scs[at]osb-alliance[dot]com</a>
          </li>
          
        </ul>
      </div>
      <div class="col-lg-7">
        <ul class="list-inline text-lg-end mt-1 mb-1">
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://social.osb-alliance.de/@SCS">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-mastodon fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://www.linkedin.com/company/sovereigncloudstack">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-linkedin-square fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://www.youtube.com/@sovereigncloudstack">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-youtube-square fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://github.com/SovereignCloudStack">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-github fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-matrix-org fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://scs.sovereignit.de/mailman3/postorius/lists/announce.lists.scs.community/">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-bullhorn fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="/feed.xml">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-rss fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
        </ul>
        <ul class="list-inline text-lg-end mt-2">
          
          <li class="list-inline-item me-2 ms-lg-2">
            <a class="text-light text-decoration-none" title="Impressum" href="/website/de/imprint/">Impressum</a>
          </li>
          
          <li class="list-inline-item me-2 ms-lg-2">
            <a class="text-light text-decoration-none" title="Datenschutzerklärung" href="/website/de/dataprotection/">Datenschutzerklärung</a>
          </li>
          
        </ul>
      </div>
    </div>
  </div>
  <!-- /.container -->
</footer>

</body>

</html>
