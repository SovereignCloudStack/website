{"version":3,"file":"main.js","sources":["src/ical-expander/IcalExpander.js","src/main.ts"],"sourcesContent":["/* eslint-disable */\n/*\nfrom https://github.com/mifi/ical-expander\nreleased under https://github.com/mifi/ical-expander/blob/master/LICENSE\noperates entirely in UTC\n*/\n\nimport * as ICAL from 'ical.js'\n\nexport class IcalExpander {\n  constructor(opts) {\n    this.maxIterations = opts.maxIterations != null ? opts.maxIterations : 1000;\n    this.skipInvalidDates = opts.skipInvalidDates != null ? opts.skipInvalidDates : false;\n\n    this.jCalData = ICAL.parse(opts.ics);\n    this.component = new ICAL.Component(this.jCalData);\n    this.events = this.component.getAllSubcomponents('vevent').map(vevent => new ICAL.Event(vevent));\n\n    if (this.skipInvalidDates) {\n      this.events = this.events.filter((evt) => {\n        try {\n          evt.startDate.toJSDate();\n          evt.endDate.toJSDate();\n          return true;\n        } catch (err) {\n          // skipping events with invalid time\n          return false;\n        }\n      });\n    }\n  }\n\n  between(after, before) {\n    function isEventWithinRange(startTime, endTime) {\n      return (!after || endTime >= after.getTime()) &&\n      (!before || startTime <= before.getTime());\n    }\n\n    function getTimes(eventOrOccurrence) {\n      const startTime = eventOrOccurrence.startDate.toJSDate().getTime();\n      let endTime = eventOrOccurrence.endDate.toJSDate().getTime();\n\n      // If it is an all day event, the end date is set to 00:00 of the next day\n      // So we need to make it be 23:59:59 to compare correctly with the given range\n      if (eventOrOccurrence.endDate.isDate && (endTime > startTime)) {\n        endTime -= 1;\n      }\n\n      return { startTime, endTime };\n    }\n\n    const exceptions = [];\n\n    this.events.forEach((event) => {\n      if (event.isRecurrenceException()) exceptions.push(event);\n    });\n\n    const ret = {\n      events: [],\n      occurrences: [],\n    };\n\n    this.events.filter(e => !e.isRecurrenceException()).forEach((event) => {\n      const exdates = [];\n\n      event.component.getAllProperties('exdate').forEach((exdateProp) => {\n        const exdate = exdateProp.getFirstValue();\n        exdates.push(exdate.toJSDate().getTime());\n      });\n\n      // Recurring event is handled differently\n      if (event.isRecurring()) {\n        const iterator = event.iterator();\n\n        let next;\n        let i = 0;\n\n        do {\n          i += 1;\n          next = iterator.next();\n          if (next) {\n            const occurrence = event.getOccurrenceDetails(next);\n\n            const { startTime, endTime } = getTimes(occurrence);\n\n            const isOccurrenceExcluded = exdates.indexOf(startTime) !== -1;\n\n            // TODO check that within same day?\n            const exception = exceptions.find(ex => ex.uid === event.uid && ex.recurrenceId.toJSDate().getTime() === occurrence.startDate.toJSDate().getTime());\n\n            // We have passed the max date, stop\n            if (before && startTime > before.getTime()) break;\n\n            // Check that we are within our range\n            if (isEventWithinRange(startTime, endTime)) {\n              if (exception) {\n                ret.events.push(exception);\n              } else if (!isOccurrenceExcluded) {\n                ret.occurrences.push(occurrence);\n              }\n            }\n          }\n        }\n        while (next && (!this.maxIterations || i < this.maxIterations));\n\n        return;\n      }\n\n      // Non-recurring event:\n      const { startTime, endTime } = getTimes(event);\n\n      if (isEventWithinRange(startTime, endTime)) ret.events.push(event);\n    });\n\n    return ret;\n  }\n\n  before(before) {\n    return this.between(undefined, before);\n  }\n\n  after(after) {\n    return this.between(after);\n  }\n\n  all() {\n    return this.between();\n  }\n}\n","import { createPlugin, EventSourceDef, EventInput, DateRange, addDays } from '@fullcalendar/common'\nimport * as ICAL from 'ical.js'\nimport { IcalExpander } from './ical-expander/IcalExpander'\n\ntype Success = (rawFeed: string, xhr: XMLHttpRequest) => void\ntype Failure = (error: string, xhr: XMLHttpRequest) => void\n\ninterface ICalFeedMeta {\n  url: string\n  format: 'ics', // for EventSourceApi\n  internalState?: InternalState // HACK. TODO: use classes in future\n}\n\ninterface InternalState {\n  completed: boolean\n  callbacks: ((errorMessage: string, iCalExpander: IcalExpander, xhr: XMLHttpRequest) => void)[]\n  errorMessage: string\n  iCalExpander: IcalExpander\n  xhr: XMLHttpRequest | null\n}\n\nlet eventSourceDef: EventSourceDef<ICalFeedMeta> = {\n\n  parseMeta(refined) {\n    if (refined.url && refined.format === 'ics') {\n      return {\n        url: refined.url,\n        format: 'ics',\n      }\n    }\n    return null\n  },\n\n  fetch(arg, onSuccess, onFailure) {\n    let { meta } = arg.eventSource\n    let { internalState } = meta\n\n    function handleICalEvents(errorMessage, iCalExpander: IcalExpander, xhr) {\n      if (errorMessage) {\n        onFailure({ message: errorMessage, xhr })\n      } else {\n        onSuccess({ rawEvents: expandICalEvents(iCalExpander, arg.range), xhr })\n      }\n    }\n\n    /*\n    NOTE: isRefetch is a HACK. we would do the recurring-expanding in a separate plugin hook,\n    but we couldn't leverage built-in allDay-guessing, among other things.\n    */\n    if (!internalState || arg.isRefetch) {\n      internalState = meta.internalState = { // our ghetto Promise\n        completed: false,\n        callbacks: [handleICalEvents],\n        errorMessage: '',\n        iCalExpander: null,\n        xhr: null,\n      }\n\n      requestICal(\n        meta.url,\n        (rawFeed, xhr) => {\n          let iCalExpander = new IcalExpander({\n            ics: rawFeed,\n            skipInvalidDates: true,\n          })\n\n          for (let callback of internalState.callbacks) {\n            callback('', iCalExpander, xhr)\n          }\n\n          internalState.completed = true\n          internalState.callbacks = []\n          internalState.iCalExpander = iCalExpander\n          internalState.xhr = xhr\n        },\n        (errorMessage, xhr) => {\n          for (let callback of internalState.callbacks) {\n            callback(errorMessage, null, xhr)\n          }\n\n          internalState.completed = true\n          internalState.callbacks = []\n          internalState.errorMessage = errorMessage\n          internalState.xhr = xhr\n        },\n      )\n    } else if (!internalState.completed) {\n      internalState.callbacks.push(handleICalEvents)\n    } else {\n      handleICalEvents(internalState.errorMessage, internalState.iCalExpander, internalState.xhr)\n    }\n  },\n}\n\nfunction requestICal(url: string, successCallback: Success, failureCallback: Failure) {\n  const xhr = new XMLHttpRequest()\n  xhr.open('GET', url, true)\n  xhr.onload = () => {\n    if (xhr.status >= 200 && xhr.status < 400) {\n      successCallback(xhr.responseText, xhr)\n    } else {\n      failureCallback('Request failed', xhr)\n    }\n  }\n  xhr.onerror = () => failureCallback('Request failed', xhr)\n  xhr.send(null)\n}\n\nfunction expandICalEvents(iCalExpander: IcalExpander, range: DateRange): EventInput[] {\n  // expand the range. because our `range` is timeZone-agnostic UTC\n  // or maybe because ical.js always produces dates in local time? i forget\n  let rangeStart = addDays(range.start, -1)\n  let rangeEnd = addDays(range.end, 1)\n\n  let iCalRes = iCalExpander.between(rangeStart, rangeEnd) // end inclusive. will give extra results\n  let expanded: EventInput[] = []\n\n  // TODO: instead of using startDate/endDate.toString to communicate allDay,\n  // we can query startDate/endDate.isDate. More efficient to avoid formatting/reparsing.\n\n  // single events\n  for (let iCalEvent of iCalRes.events) {\n    expanded.push({\n      ...buildNonDateProps(iCalEvent),\n      start: iCalEvent.startDate.toString(),\n      end: (specifiesEnd(iCalEvent) && iCalEvent.endDate)\n        ? iCalEvent.endDate.toString()\n        : null,\n    })\n  }\n\n  // recurring event instances\n  for (let iCalOccurence of iCalRes.occurrences) {\n    let iCalEvent = iCalOccurence.item\n    expanded.push({\n      ...buildNonDateProps(iCalEvent),\n      start: iCalOccurence.startDate.toString(),\n      end: (specifiesEnd(iCalEvent) && iCalOccurence.endDate)\n        ? iCalOccurence.endDate.toString()\n        : null,\n    })\n  }\n\n  return expanded\n}\n\nfunction buildNonDateProps(iCalEvent: ICAL.Event): EventInput {\n  return {\n    title: iCalEvent.summary,\n    url: extractEventUrl(iCalEvent),\n    extendedProps: {\n      location: iCalEvent.location,\n      organizer: iCalEvent.organizer,\n      description: iCalEvent.description,\n    },\n  }\n}\n\nfunction extractEventUrl(iCalEvent: ICAL.Event): string {\n  let urlProp = iCalEvent.component.getFirstProperty('url')\n  return urlProp ? urlProp.getFirstValue() : ''\n}\n\nfunction specifiesEnd(iCalEvent: ICAL.Event) {\n  return Boolean(iCalEvent.component.getFirstProperty('dtend')) ||\n    Boolean(iCalEvent.component.getFirstProperty('duration'))\n}\n\nexport default createPlugin({\n  eventSourceDefs: [eventSourceDef],\n})\n"],"names":[],"mappings":"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"}