<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  

  <title>Automating SONiC switch provisioning and management with NetBox as a central source | Sovereign Cloud Stack</title>
  <meta property="og:title" content="Automating SONiC switch provisioning and management with NetBox as a central source | Sovereign Cloud Stack">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:locale" content="en" />
<meta name="description" content="Automating network infrastructure is essential for improving efficiency, scalability, and accuracy, particularly in large-scale environments. In our setup, we’ve developed a system that automates the provisioning and management of a fleet of SONiC switches by leveraging tools like Zero-Touch Provisioning (ZTP), Open Network Install Environment (ONIE), and NetBox as our single source of truth. This configuration reduces the need for manual setup, minimizes human error, and accelerates deployment by centralizing control within NetBox, ultimately streamlining device provisioning and configuration across the network." />
<meta property="og:description" content="Automating network infrastructure is essential for improving efficiency, scalability, and accuracy, particularly in large-scale environments. In our setup, we’ve developed a system that automates the provisioning and management of a fleet of SONiC switches by leveraging tools like Zero-Touch Provisioning (ZTP), Open Network Install Environment (ONIE), and NetBox as our single source of truth. This configuration reduces the need for manual setup, minimizes human error, and accelerates deployment by centralizing control within NetBox, ultimately streamlining device provisioning and configuration across the network." />
<link rel="canonical" href="https://scs.community/tech/2024/11/12/sonic/" />
<meta property="og:url" content="https://scs.community/tech/2024/11/12/sonic/" />
<meta property="og:site_name" content="Sovereign Cloud Stack" />
<meta property="og:image" content="https://scs.community/assets/images/default-card-d32fdb798ca15ae927f00593ce64407f69c70d4011955dc94c7be76b99c474f4e673ee1a26ec53725dda80c2c331e5ad4300a43e702171cc014cd47ec6b2f94d.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-11-12T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://scs.community/assets/images/default-card-d32fdb798ca15ae927f00593ce64407f69c70d4011955dc94c7be76b99c474f4e673ee1a26ec53725dda80c2c331e5ad4300a43e702171cc014cd47ec6b2f94d.jpg" />
<meta property="twitter:title" content="Automating SONiC switch provisioning and management with NetBox as a central source" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-15T05:25:24+00:00","datePublished":"2024-11-12T00:00:00+00:00","description":"Automating network infrastructure is essential for improving efficiency, scalability, and accuracy, particularly in large-scale environments. In our setup, we’ve developed a system that automates the provisioning and management of a fleet of SONiC switches by leveraging tools like Zero-Touch Provisioning (ZTP), Open Network Install Environment (ONIE), and NetBox as our single source of truth. This configuration reduces the need for manual setup, minimizes human error, and accelerates deployment by centralizing control within NetBox, ultimately streamlining device provisioning and configuration across the network.","headline":"Automating SONiC switch provisioning and management with NetBox as a central source","image":"default-card.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://scs.community/tech/2024/11/12/sonic/"},"url":"https://scs.community/tech/2024/11/12/sonic/"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="https://scs.community/feed.xml" title="Sovereign Cloud Stack" />


  <!-- Matomo -->
  <script>
    if (typeof(Storage) !== 'undefined') {
    	if (localStorage.getItem('matomoTrackingEnabled') === null) {
    		localStorage.setItem('matomoTrackingEnabled', 'true');
    	}
    }
  </script>
  <script>
    if (localStorage.getItem('matomoTrackingEnabled') !== 'false') {
      var _paq = window._paq = window._paq || [];
      _paq.push(['disableCookies']);
      _paq.push(["setDoNotTrack", true]);
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://matomo.scs.community/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '1']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    }
  </script>
  <!-- End Matomo Code -->

  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="/assets/vendor/jquery/jquery-a0b8b972af0e63f0a8ff91994568d150c0e76de30c09ae1ed8405692fa313fa0d534458612a8a71e9a7e4dced5349cff481fbd863e19b98b6d41fb4881cd62be.js" integrity="sha512-oLi5cq8OY/Co/5GZRWjRUMDnbeMMCa4e2EBWkvoxP6DVNEWGEqinHpp+Tc7VNJz/SB+9hj4ZuYttQftIgc1ivg==" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/vendor/bootstrap/js/bootstrap.bundle-d8e114e4e623acf24bb3c3cbf6a906fbd37e0db1c1aaf5a3123954efaae74ad62f651ce863c9368b9fed706d608f0fe3c281a1b989179b4d917377fa1c653eb7.js" integrity="sha512-2OEU5OYjrPJLs8PL9qkG+9N+DbHBqvWjEjlU76rnStYvZRzoY8k2i5/tcG1gjw/jwoGhuYkXm02Rc3f6HGU+tw==" crossorigin="anonymous"></script>
  <!-- Lighbox -->
  <script type="text/javascript" src="/assets/vendor/lightbox-02cc852cceea74c2b61add6b54cff8c2c48278e3da09b13c2aa41b4abb82a5ecfe3ad53fe5f12da728c0b5990f06a2a3a5fe9c9c2ebdef40d93421cac0b267cc.js" integrity="sha512-AsyFLM7qdMK2Gt1rVM/4wsSCeOPaCbE8KqQbSruCpez+OtU/5fEtpyjAtZkPBqKjpf6cnC6970DZNCHKwLJnzA==" crossorigin="anonymous"></script>
  <link rel="stylesheet" type="text/css" href="/assets/css/lightbox-0184be351f33358fce8415b3f8bdda50e58ee86ff1de0b37d00a26f602e14fc61896ad0bb90662299dea49767123bfe2c724163867b097f5f92cc1785e324cad.css" integrity="sha512-AYS+NR8zNY/OhBWz+L3aUOWO6G/x3gs30Aom9gLhT8YYlq0LuQZiKZ3qSXZxI7/ixyQWOGewl/X5LMF4XjJMrQ==" crossorigin="anonymous">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" type="text/css" href="/assets/css/main-b8cf68a63f9b26ea819f67d4e3a173489daf6c6c7de17051d360d8e72b41c67279d732bd19f4a04210326db8595205b80d704f640296bb5f5f63bedc042df118.css" integrity="sha512-uM9opj+bJuqBn2fU46FzSJ2vbGx94XBR02DY5ytBxnJ51zK9GfSgQhAybbhZUgW4DXBPZAKWu19fY77cBC3xGA==" crossorigin="anonymous">
  <!-- Pygments CSS -->
  <link rel="stylesheet" type="text/css" href="/assets/css/pygments-css/zenburn-b9247179f996de88844d73acaa60564a48db30aa0fec022f80b7641b41d45140625b657433da3bd722f68ba2fed77bfaa94972b9eed09c77a427e04a1707917e.css" integrity="sha512-uSRxefmW3oiETXOsqmBWSkjbMKoP7AIvgLdkG0HUUUBiW2V0M9o71yL2i6L+13v6qUlyue7QnHekJ+BKFweRfg==" crossorigin="anonymous">
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon-50d41dce7bb6498cab01cffd5f46e59a664056fd725ecf84d9c8e5ad9ac8ca1470a0b82fe79789d09136c4a7999658948394d89d9764e4174dfeec26fa7636ae.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32-c5b260bd36bab2cb0496cec647907efc38ca4ac5cb5c978603405fe682da762b16d3b21e997fc85c1c76db4e4bae08787a9a9cbfeb38c7b796ea6de38011953b.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16-01a7499e8495e00e13117aca0a759d19faeca0c8fe23c003bf5aabef7b7b5abbbb1ad3d149d0630d9997f941fb53e13d85a950be0104d76283df37fbaba34717.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="mask-icon" color="#50c3a5" href="/assets/images/safari-pinned-tab-3194c271a2bc561b5707fb2998d39947f8feeabebcc64dfb41004e04f7ae120a6ae7157839c91b2b6f0920545a23959142d86e565ba6250800bafb99a2237583.svg" />
  <meta name="msapplication-config" content="/browserconfig.xml" />
  <meta name="msapplication-TileColor" content="#50c3a5">
  <meta name="theme-color" content="#ffffff">
</head>


<body class="d-flex flex-column min-vh-100">
  <!-- Navigation -->
<nav class="navbar navbar-dark bg-gold sticky-top" style="height: 55px;">
  <div class="container d-flex justify-content-center">
	  <a class="lh-1 fw-bolder link-unstyled text-center stretched-link" href="https://sovereigncloudstack.org/">Discover our new web page</a>
  </div>
</nav>
<nav class="navbar navbar-expand-lg navbar-light sticky-top bg-light">
  <div class="container align-items-start">
    <div class="d-lg-flex flex-row flex-fill align-items-end">
      <button
        class="navbar-toggler me-auto"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto">
          
          <li class="nav-item">
            
              <a class="nav-link" href="/">
                Home
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Discover SCS
              </a>
                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                  
                    <li><a class="dropdown-item" href="/about/">About SCS</a></li>
                  
                    <li><a class="dropdown-item" href="/use/">Use SCS</a></li>
                  
                    <li><a class="dropdown-item" href="/contribute/">Contribute to SCS</a></li>
                  
                    <li><a class="dropdown-item" href="/partners/">Service partners</a></li>
                  
                    <li><a class="dropdown-item" href="/members/">Community members</a></li>
                  
              </ul>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/news/">
                News
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/events/">
                Events
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/jobs/">
                Open positions
              </a>
            
          
          <li class="nav-item">
            
              <a class="nav-link" href="/tenders/">
                Public tenders
              </a>
            
          
          </li>
          <li><a class="nav-link" href="https://docs.scs.community">Documentation</a></li>
        </ul>
        <ul class="navbar-nav flex-row align-content-end">
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://social.osb-alliance.de/@SCS">
              <i class="fa fa-mastodon fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://www.linkedin.com/company/sovereigncloudstack">
              <i class="fa fa-linkedin-square fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://www.youtube.com/@sovereigncloudstack">
              <i class="fa fa-youtube-square fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://github.com/SovereignCloudStack">
              <i class="fa fa-github fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org">
              <i class="fa fa-matrix-org fa-lg"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="https://scs.sovereignit.de/mailman3/postorius/lists/announce.lists.scs.community/">
              <i class="fa fa-bullhorn"></i>
            </a>
          </li>
          
          <li class="nav-item my-auto me-3 mx-lg-0">
            <a class="nav-link" target="_blank" rel="me" href="/feed.xml">
              <i class="fa fa-rss"></i>
            </a>
          </li>
          
        </ul>
      </div>
      <div class="d-none d-lg-block">
        <ul class="navbar-nav flex-row">
  <li class="nav-item my-auto ms-4 ms-lg-2">
    <a class="nav-link fw-bold  text-decoration-underline  " href="/tech/2024/11/12/sonic/">EN</a>
  </li>
  <li class="nav-item my-auto mx-2 mx-lg-0">
    <span class="nav-link px-0">/</span>
  </li>
  <li clas="nav-item my-auto">
    <a class="nav-link fw-bold  " href="/de/tech/2024/11/12/sonic/">DE</a>
  </li>
</ul>
      </div>
    </div>
    <div class="d-lg-none">
      <ul class="navbar-nav flex-row">
  <li class="nav-item my-auto ms-4 ms-lg-2">
    <a class="nav-link fw-bold  text-decoration-underline  " href="/tech/2024/11/12/sonic/">EN</a>
  </li>
  <li class="nav-item my-auto mx-2 mx-lg-0">
    <span class="nav-link px-0">/</span>
  </li>
  <li clas="nav-item my-auto">
    <a class="nav-link fw-bold  " href="/de/tech/2024/11/12/sonic/">DE</a>
  </li>
</ul>
    </div>
  </div>
</nav>
 <!-- Header -->
<header class="bg-white py-2 mb-2">
  <div class="container h-100">
    <div class="row h-100 align-items-center">
      <div class="col-lg-6 pe-lg-4">
        <div class="mt-5 mb-3">
          <img alt="Sovereign Cloud Stack" width="50%" class="img-fluid" src="/assets/images/SCS_horizontal-749ea34c9192a57edc36f112b92ac2eddb847d3e47643f37488b3d148c9b98a720215c0c8e17ad0d3837c9056ae6feae3cdc931ed36e911b2b1b61a20b417de6.svg" integrity="sha512-dJ6jTJGSpX7cNvESuSrC7duEfT5HZD83SIs9FIybmKcgIVwMjhetDTg3yQVq5v6uPNyTHtNukRsrG2GiC0F95g==" crossorigin="anonymous">
        </div>
        <p class="lead text-black-50 mb-lg-3">
          One platform — standardized, built and operated by many.
        </p>
      </div>
      <div class="col-lg-6 text-lg-end text-nowrap my-auto">
        <a href="https://osb-alliance.com" target="_blank" class="text-decoration-none">
          <img alt="Open Source Business Alliance" width="25%" class="img-fluid" src="/assets/images/logo-osba-615e489a04d99f1ead83a6fa64d76dfc96d1f6a8448ee5457099e2bc8fddb235379f6607e917a0fcfb519ff1902ac5596213d7339ef9f48a0925aaf2b1221ee0.svg" integrity="sha512-YV5ImgTZnx6tg6b6ZNdt/JbR9qhEjuVFcJnivI/dsjU3n2YH6Reg/PtRn/GQKsVZYhPXM5759IoJJarysSIe4A==" crossorigin="anonymous">
        </a>
        <a href="https://bmwk.de" target="_blank" class="text-decoration-none">
          <img alt="Bundesministerium für Wirtschaft und Klimaschutz" width="25%" class="img-fluid ms-5" src="/assets/images/logo-bmwk-funded-a4b929201f73ab45853836459b686db98f0b2e37189400588ce992a51c6c59d371835e93cd0d5b891f05fce75d6b87383c3fc12d52c6d560c5602eb32bf58b90.svg" integrity="sha512-pLkpIB9zq0WFODZFm2htuY8LLjcYlABYjOmSpRxsWdNxg16TzQ1biR8F/Odda4c4PD/BLVLG1WDFYC6zK/WLkA==" crossorigin="anonymous">
        </a>
        <a href="https://gaia-x.eu" target="_blank" class="text-decoration-none">
          <img alt="Gaia-X" width="30%" class="img-fluid ms-3" src="/assets/images/logo-gaiax-fbfa0132aaba3946d970e942fd98ef403abb12f8f344cc3087fcb466e23424b0d7dddd9b8b2ce4979df58e4b78e48f0419eb721e0f0599bd89df6b46c2871c43.svg" integrity="sha512-+/oBMqq6OUbZcOlC/ZjvQDq7EvjzRMwwh/y0ZuI0JLDX3d2biyzkl531jkt45I8EGetyHg8Fmb2J32tGwoccQw==" crossorigin="anonymous">
        </a>
      </div>
    </div>
  </div>
</header>

  <!-- Page Content -->
  <div class="container mb-5">
    
<div class="d-flex w-100 flex-column mb-3">
	<h1 class="pb-1 mb-0"><small>Automating SONiC switch provisioning and management with NetBox as a central source</small></h1>
	<div class="d-flex w-100 flex-row">
		<div style="max-width: 80px; max-height: 80px;" class="rounded-3 overflow-hidden ratio ratio-1x1">
			<div style="max-width: 80px; max-height: 80px;" class="overflow-hidden ratio ratio-1x1">

  <svg height="80" width="80">
    
    
    <mask id="e84952b38b8a">
      <rect width="80" height="80" fill="white"/>
    </mask>
    <mask id="c765e2776674">
        <circle cx="40" cy="40" r="40" fill="white"/>
    </mask>
    <image x="0" y="0" height="80" width="80" xlink:href="/assets/4f80f8-515b5738cb41f0ae8a367ce86d71234fce607bf03b5f7f0a62c034f208563fa37f436694047daab16f814f08d843645fc38ce54ec4bf9e432d4fabd47e8fb140.webp"
       mask="url(#c765e2776674)" 
    ></image>
  </svg>

</div>

		</div>
		<div class="d-flex w-100 flex-column ms-3 my-auto">
			<small class="mb-1 fw-bolder">Matej Feder</small>
			<small>
	November 12, 2024

</small>
		</div>
	</div>
</div>

<p>Automating network infrastructure is essential for improving efficiency, scalability, and accuracy, particularly in
large-scale environments. In our setup, we’ve developed a system that automates the provisioning and management of a fleet
of SONiC switches by leveraging tools like Zero-Touch Provisioning (ZTP), Open Network Install Environment (ONIE),
and NetBox as our single source of truth.
This configuration reduces the need for manual setup, minimizes human error, and accelerates deployment by centralizing
control within NetBox, ultimately streamlining device provisioning and configuration across the network.</p>

<h2 id="provisioning">Provisioning</h2>

<p>The architecture for automating the provisioning of SONiC switches relies on several key components:</p>

<ul>
  <li>DHCP Server: Provides initial network configuration for new switches, directing them to ONIE and ZTP for loading the SONiC image and retrieving initial configuration.</li>
  <li>HTTP Server: Hosts SONiC images, ZTP configuration file, and scripts, making them available for download during provisioning.</li>
  <li>NetBox: Acts as the central source of truth, storing device information, configuration template, and scripts that automate ongoing switch management.</li>
</ul>

<figure class="figure mx-auto d-block" style="width:50%">
  <a href="/assets/images/blog/sonic/sonic_netbox-6bf94a80c79edb0aefdb5299b9dc5928e0d01873bdecf6fc60efe7b47a9f0ba4f1c5933c1d894d8de727eb9dba6291b00017f63ded69567182ad47eb58953262.png">
    <img class="figure-img w-100" src="/assets/images/blog/sonic/sonic_netbox-6bf94a80c79edb0aefdb5299b9dc5928e0d01873bdecf6fc60efe7b47a9f0ba4f1c5933c1d894d8de727eb9dba6291b00017f63ded69567182ad47eb58953262.png" integrity="sha512-a/lKgMee2wrv21KZudxZKODQGHO97Pb8YO/ntHqfC6TxxZM8HYlNjecn6526YpGwABf2Pe1pVnGCrUfrWJUyYg==" crossorigin="anonymous" />
  </a>
</figure>

<h3 id="dhcp-server">DHCP server</h3>

<p>The DHCP server plays a critical role in the initial provisioning phase. When a new SONiC switch connects to the network,
the DHCP server assigns it an IP address and provides options for ONIE and ZTP, guiding the switch to download the
SONiC image and its configuration.</p>

<p>The DHCP server can employ various configuration strategies, such as using the vendor-class-identifier to filter devices.
Some of these strategies are detailed in <a href="https://github.com/sonic-net/SONiC/blob/master/doc/ztp/ztp.md">ZTP docs</a> and <a href="https://opencomputeproject.github.io/onie/user-guide/index.html">ONIE docs</a>.</p>

<p>Below is an example of a basic DHCP configuration for a host in the SCS lab environment:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>host &lt;host&gt; {
  hardware ethernet &lt;mac-address&gt;;
  server-name "&lt;server-name&gt;";
  option host-name "&lt;host-name&gt;";
  fixed-address &lt;ipv4-address&gt;;
  option default-url "&lt;http-server-address&gt;/sonic-image.bin";
  option bootfile-name "&lt;http-server-address&gt;/ztp.json";
  }
</code></pre></div></div>

<h3 id="http-server">HTTP server</h3>

<p>The HTTP server stores essential files, including the SONiC image and configuration scripts, which ZTP uses to set up
the switch. This server needs to be accessible from the network where the switches are deployed.</p>

<h3 id="netbox">NetBox</h3>

<p>NetBox serves as the backbone of this automated setup, providing a structured and centralized source of truth for device
configurations and management scripts. The configuration for SONiC switches combines a configuration template,
the device’s state as defined in NetBox, and configuration context with static settings such as IP addresses for NTP servers.</p>

<p>The following diagram shows the flow of information used to generate the final SONiC configuration:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Configuration context       NetBox device state
       |                         |
       v                         v
     --------------------------------
    | SONiC configuration template   |
     --------------------------------
                 |
                 v
       ------------------------
      |   SONiC configuration  |
       ------------------------
</code></pre></div></div>

<p>The SONiC configuration is dynamically generated based on the information stored in NetBox and retrieved via its API.
This approach ensures consistency, as the configuration for each switch can be managed centrally and tailored to each
device’s specifications.</p>

<h3 id="onie">ONIE</h3>

<p>ONIE is an open-source boot loader designed to automate the installation of a network operating system (NOS) on bare-metal
network switches. Developed by Cumulus Networks and now widely supported by the Open Compute Project (OCP), ONIE enables
network flexibility by supporting various NOS options, including SONiC, across different hardware platforms.</p>

<p>When a switch with ONIE boots, it enters a discovery mode where it attempts to locate and install a NOS. This process can
be configured through multiple methods, with DHCP being one of the most common. In our DHCP configuration, ONIE retrieves
a designated NOS image URL, allowing it to automatically download and install the appropriate SONiC version as required.</p>

<h3 id="ztp">ZTP</h3>

<p>ZTP is an automated method that streamlines the setup of SONiC network devices, allowing them to be deployed directly
to a site, download configuration files, and begin operation without any manual intervention. This approach significantly
reduces configuration time, minimizes human error, and simplifies scaling.</p>

<p>In our SCS LAB deployment, ZTP enables the initial configuration of network switches.
The ZTP configuration file includes steps to execute essential scripts, retrieve configurations from NetBox (our source of truth),
and validate connectivity. Specifically, the provisioning script within this file pulls the switch’s configuration from
NetBox based on its hostname, ensuring each device receives the appropriate settings, such as interface configurations,
VLANs, BGP configuration and more. Once the configuration is applied, the device automatically reboots, entering its
operational state.</p>

<p>The ZTP configuration file we used is structured as follows:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"ztp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"01-prerequisites-script"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"plugin"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;http-server-address&gt;/prerequisites.sh"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"02-provisioning-script"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"plugin"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;http-server-address&gt;/provision.sh"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ignore-section-data"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="s2">"--netbox-url &lt;netbox-url&gt; --netbox-token &lt;netbox-token&gt;"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"03-connectivity-check"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ping-hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"&lt;ip-address-that-should-be-reachable&gt;"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"reboot-on-success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>For a detailed example of scripts, visit the related <a href="https://github.com/SovereignCloudStack/hardware-landscape">repository</a>.</p>

<h2 id="management">Management</h2>

<p>In modern network infrastructures, managing switch configurations can become a complex task, especially when dealing
with scalable environments. To streamline network configuration for SONiC devices, we’ve implemented an MVP (Minimum Viable
Product) integration between NetBox and SONiC. This integration leverages NetBox’s data management capabilities with
custom scripts that help automate configuration synchronization for SONiC devices, making it easier to keep network
configurations consistent and compliant.</p>

<p>NetBox has been enhanced to support configuration management for SONiC devices through two custom scripts that automate
configuration tasks. These scripts <code class="language-plaintext highlighter-rouge">SONiC Config Diff</code> and <code class="language-plaintext highlighter-rouge">SONiC Config Sync</code> are designed to align SONiC device
configurations with what’s defined in NetBox. Currently, these scripts are executed manually and offer limited
functionality, but they set the groundwork for more comprehensive network management.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                 +----------------------+
                                 |         NetBox       |
                                 +----------------------+
                                /|   Sonic Config Diff  |\
                               / |   Sonic Config Sync  | \ 
                              /  +----------------------+  \
                             /              |               \
                            /               |                \
           +-------------------+    +-------------------+     +-------------------+
           |     SONiC SW 1    |    |     SONiC SW 2    | ... |     SONiC SW N    |
           +-------------------+    +-------------------+     +-------------------+
</code></pre></div></div>

<h3 id="sonic-config-diff">SONiC Config Diff</h3>

<p>This script identifies configuration discrepancies between SONiC devices and NetBox. By comparing the running
configuration on SONiC devices with the stored configuration in NetBox, Config Diff highlights differences that could
affect compliance. This script builds on the <code class="language-plaintext highlighter-rouge">netbox-config-diff</code> plugin, extending its capabilities to support SONiC NOS.</p>

<figure class="figure mx-auto d-block" style="width:50%">
  <a href="/assets/images/blog/sonic/netbox_config_compliant-dbbeb66afb59592380b9b4ac41f9110eb4443b1a611e86027ed115694abff321efbca14f2d6e4b2f6757c4b08b1b940468422eba0f382876dc74d1c6020df953.png">
    <img class="figure-img w-100" src="/assets/images/blog/sonic/netbox_config_compliant-dbbeb66afb59592380b9b4ac41f9110eb4443b1a611e86027ed115694abff321efbca14f2d6e4b2f6757c4b08b1b940468422eba0f382876dc74d1c6020df953.png" integrity="sha512-2762avtZWSOAubSsQfkRDrREOxphHoYCftEVaUq/8yHvvKFPLW5LL2dXxLCLG5QEaEIuug84KHbcdNHGAg35Uw==" crossorigin="anonymous" />
  </a>
</figure>

<p>When run, SONiC Config Diff produces a report showing where device settings deviate from the intended configuration,
allowing administrators to easily spot inconsistencies. These results are presented in a visual format, making it easy
to assess compliance at a glance:</p>

<figure class="figure mx-auto d-block" style="width:50%">
  <a href="/assets/images/blog/sonic/netbox_config_diff-d5fc31ffea2f68a9fd0296c150cea70e045bf3e9bc070bd0c0ab41f5b145cbf0a1c49e3802c161111487dc259fc1aad557967d3ff5805aa9146a65f319346e51.png">
    <img class="figure-img w-100" src="/assets/images/blog/sonic/netbox_config_diff-d5fc31ffea2f68a9fd0296c150cea70e045bf3e9bc070bd0c0ab41f5b145cbf0a1c49e3802c161111487dc259fc1aad557967d3ff5805aa9146a65f319346e51.png" integrity="sha512-1fwx/+ovaKn9ApbBUM6nDgRb8+m8BwvQwKtB9bFFy/ChxJ44AsFhERSH3CWfwarVV5Z9P/WAWqkUamXzGTRuUQ==" crossorigin="anonymous" />
  </a>
</figure>

<h3 id="sonic-config-sync">SONiC Config Sync</h3>

<p>While Config Diff identifies differences, SONiC Config Sync enables administrators to apply updates to the SONiC device
based on NetBox configurations. This synchronization process allows NetBox to push missing configuration elements to
SONiC devices, helping bring them up to date with the desired setup. Config Sync is a step toward automated configuration
management, though it only adds configurations and doesn’t support full bidirectional synchronization yet.
Like Config Diff, it can be targeted to specific SONiC devices or run across multiple devices using filters like site,
rack, or device role:</p>

<figure class="figure mx-auto d-block" style="width:50%">
  <a href="/assets/images/blog/sonic/netbox_config_sync-45f57252e9689a3884fca082fae8b17792523b49b6dd850a03e0fa813b0dabecf576eee59cb7e477cae316ddb3a3b183165a72aae4f6dd07c7af0b28cbb66d7d.png">
    <img class="figure-img w-100" src="/assets/images/blog/sonic/netbox_config_sync-45f57252e9689a3884fca082fae8b17792523b49b6dd850a03e0fa813b0dabecf576eee59cb7e477cae316ddb3a3b183165a72aae4f6dd07c7af0b28cbb66d7d.png" integrity="sha512-RfVyUulomjiE/KCC+uixd5JSO0m23YUKA+D6gTsNq+z1du7lnLfkd8rjFt2zo7GDFlpyquT23QfHrwsoy7ZtfQ==" crossorigin="anonymous" />
  </a>
</figure>

<p>The result is then visualized as follows:</p>

<figure class="figure mx-auto d-block" style="width:50%">
  <a href="/assets/images/blog/sonic/netbox_config_sync_done-7b9a64563cd9ef6fc4fd1d5e9ed2ea6b2a6326d14f1f6f987f6f728d5a4e287d916e2a7034fc483efee6381257bb0592549d0611a217d13e5c020113494971e9.png">
    <img class="figure-img w-100" src="/assets/images/blog/sonic/netbox_config_sync_done-7b9a64563cd9ef6fc4fd1d5e9ed2ea6b2a6326d14f1f6f987f6f728d5a4e287d916e2a7034fc483efee6381257bb0592549d0611a217d13e5c020113494971e9.png" integrity="sha512-e5pkVjzZ72/E/R1entLqaypjJtFPH2+Yf29yjVpOKH2RbipwNPxIPv7mOBJXuwWSVJ0GEaIX0T5cAgETSUlx6Q==" crossorigin="anonymous" />
  </a>
</figure>

<p>This blog covers the provisioning and management of SONiC switches,advancing the automation of scalable network environments.
By combining NetBox’s management capabilities with the flexible, open-source SONiC platform, we are laying the foundation
for simplifying administration and reducing operational complexity.</p>

<p>⚙️ Happy automation!</p>



<h2 id="about">
  
    About the author
  
</h2>




<div class="d-flex flex-md-row flex-column align-items-center mb-5">
    <div class="me-4 d-flex align-items-center">
      <svg height="120" width="120">
        
        <mask id="d55bea5dadd2">
          <circle cx="60" cy="60" r="60" fill="white"/>
        </mask>
        <image x="0" y="0" height="120" width="120" xlink:href="/assets/81078a-847ba2c26740ad21125511b68d17b11254760f78ed5867d79fc821117b9ae44685505ac7b6df45c90035629e36bed2bc676a93d41cf3b1367dc3528e3eb443b6.webp" mask="url(#d55bea5dadd2)"></image>
      </svg>
    </div>
    <div class="d-flex flex-column pe-3">
        <div class="mb-0 text-center text-md-start"><b>Matej Féder</b></div>
        <div class="small text-muted mt-0 text-center text-md-start">Software Engineer @ <a href="https://dnation.cloud/" target="_blank">dNation</a></div>
        <div class="mt-2">Matej is a software engineer with an interest in programming, and cloud-native technologies.
</div>
        <div class="mt-2 d-flex flex-row flex-wrap">
          
<div class="me-2 mb-2">
    <a class="btn btn-mail" href="mailto:matej.feder@dnation.cloud"><i class="fa fa-envelope fa-lg"></i></a>
</div>





<div class="me-2 mb-2">
    <a class="btn btn-linkedin" target="_blank" href="https://www.linkedin.com/in/matej-feder-9bba27111/"><i class="fa fa-linkedin fa-lg"></i></a>
</div>


<div class="me-2 mb-2">
    <a class="btn btn-github" target="_blank" href="https://github.com/matofeder"><i class="fa fa-github fa-lg"></i></a>
</div>


<div class="me-2 mb-2">
    <a class="btn btn-matrix" target="_blank" href="https://matrix.to/#/@mfeder:matrix.org"><i class="fa fa-matrix-org fa-lg"></i></a>
</div>

          <div class="ms-md-auto pe-3"><a href="/members/matofeder" class="btn btn-outline-primary" role="button">Community profile &raquo;</a></div>
      </div>
    </div>
</div>



  </div>
  <!-- /.container -->
  <!-- Footer -->
<footer class="py-5 bg-dark">
  <div class="container text-light bg-dark">
    <div class="row">
      <div class="col-lg-5">
        <a href="#" class="footer-site-logo">
          <img alt="Sovereign Cloud Stack" class="img-fluid mb-2" src="/assets/images/SCS_short-1b31802be07ab137d2373f3cd2e268923d727ee1d19b6b577dff3b71610345de088c3b83c90f66897a21e52e84fa03c1ef4d1ca5193b8659b9c9535946aa0154.svg" integrity="sha512-GzGAK+B6sTfSNz880uJokj1yfuHRm2tXff87cWEDRd4IjDuDyQ9miXoh5S6E+gPB700cpRk7hlm5yVNZRqoBVA==" crossorigin="anonymous">
        </a>
        <p class="small my-1">Sovereign Cloud Stack, SCS and the logo are registered trademarks of the Open Source Business Alliance e.V. — Other trademarks are property of their respective owners.</p>
        <ul class="list-inline mt-2 mb-1">
          
          <li class="list-inline-item small me-sm-4 me-3">
            <i class="text-light fa fa-phone me-1"></i> <a class="text-light text-decoration-none" href="tel:+49-30-300149-3377" title="+49-30-300149-3377">+49-30-300149-3377</a>
          </li>
          
          <li class="list-inline-item small me-sm-4 me-3">
            <i class="text-light fa fa-envelope me-1"></i> <a class="text-light text-decoration-none" href="mailto:scs@osb-alliance.com" title="scs[at]osb-alliance[dot]com">scs[at]osb-alliance[dot]com</a>
          </li>
          
        </ul>
      </div>
      <div class="col-lg-7">
        <ul class="list-inline text-lg-end mt-1 mb-1">
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://social.osb-alliance.de/@SCS">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-mastodon fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://www.linkedin.com/company/sovereigncloudstack">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-linkedin-square fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://www.youtube.com/@sovereigncloudstack">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-youtube-square fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://github.com/SovereignCloudStack">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-github fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://matrix.to/#/!TiDqlLmEUaXqTemaLc:matrix.org?via=matrix.org">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-matrix-org fa-lg fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="https://scs.sovereignit.de/mailman3/postorius/lists/announce.lists.scs.community/">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-bullhorn fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
          <li class="list-inline-item me-2">
            <span class="fa-stack fa-lg">
            <a target="_blank" href="/feed.xml">
              <i class="text-gray fa fa-square fa-stack-2x"></i>
              <i class="text-white fa fa-rss fa-stack-1x"></i>
            </a>
            </span>
          </li>
          
        </ul>
        <ul class="list-inline text-lg-end mt-2">
          
          <li class="list-inline-item me-2 ms-lg-2">
            <a class="text-light text-decoration-none" title="Imprint" href="/imprint/">Imprint</a>
          </li>
          
          <li class="list-inline-item me-2 ms-lg-2">
            <a class="text-light text-decoration-none" title="Data Protection Statement" href="/dataprotection/">Data Protection Statement</a>
          </li>
          
        </ul>
      </div>
    </div>
  </div>
  <!-- /.container -->
</footer>

</body>

</html>
